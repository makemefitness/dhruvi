!!!
%html
  %head
    %meta{:content => "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}/
    %title
      = yield(:title) + " | CRM Trener Dhruvi"
    = favicon_link_tag asset_path('favicon.png')
    %meta{:content => "width=device-width,initial-scale=1", :name => "viewport"}/
    = csrf_meta_tags
    = csp_meta_tag
    %script{crossorigin: "anonymous", integrity: "sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=", src: "https://code.jquery.com/jquery-3.7.1.min.js"}
    %script{crossorigin: "anonymous", integrity: "sha512-Z/2pIbAzFuLlc7WIt/xifag7As7GuTqoBbLsVTgut69QynAIOclmweT6o7pkxVoGGfLcmPJKn/lnxyMNKBAKgg==", referrerpolicy: "no-referrer", src: "https://cdnjs.cloudflare.com/ajax/libs/easy-autocomplete/1.3.5/jquery.easy-autocomplete.min.js"}

    
    %link{crossorigin: "anonymous", href: "https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css", integrity: "sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN", rel: "stylesheet"}/
    %link{crossorigin: "anonymous", href: "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css", integrity: "sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==", referrerpolicy: "no-referrer", rel: "stylesheet"}/

    %link{href: "https://unpkg.com/trix@2.0.0/dist/trix.css", rel: "stylesheet", type: "text/css"}/
    %script{src: "https://unpkg.com/trix@2.0.0/dist/trix.umd.min.js", type: "text/javascript"} 

    %link{href: "https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@10.2.7/dist/css/autoComplete.min.css", rel: "stylesheet"}/

    %link{:href => "https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css", :rel => "stylesheet"}/
    
    = stylesheet_link_tag "application", "data-turbo-track": "reload"
    
    -# = javascript_importmap_tags
    = javascript_include_tag "application", "data-turbo-track": "reload", defer: true
    -# = javascript_include_tag "jquery"
    = javascript_include_tag :cocoon
  %body
    
    - unless log_in?
      %main.dhruvi-help
        %main.main-view
          = yield
    - else
      .my-container 
        %header.header
          .logo.d-bloc
            = image_tag "logo.png", alt: "logo", class: "logo"
            
          <!-- FORMULARZ -->
          -# = form_for :customers, method: :get, :html => {class: 'search'} do |f|
          -#   = text_field_tag :keywords, nil, placeholder: "First name, Surname lub Email", class: "search__input"
          -#   %button.search__button
          -#     %svg.search__icon
          -#       %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-magnifying-glass"}
          = form_with url: search_path, local: true, method: :get, html: { class: 'search'} do |form|
            = form.text_field  :q, placeholder: 'First name, Surname lub Email', data: {behavior: "autocomplete"}, id: 'easyAutocompleteA', class: 'search__input'
            = form.button "search", class: 'search__button' do
              %svg.search__icon
                %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-magnifying-glass"}
          ////////////////////////////////////////////////////////////////////////////////////////////////////
          <!-- = javascript_pack_tag 'javascript/search' -->
          %script
            let input = $('#easyAutocompleteA');
            let options = { 
            getValue: "name",
            url: function(phrase){
            return "/search?q=" + phrase;
            },
            categories: [
            {
            listLocation: 'customers',
            header: "<strong>Customers</strong>"
            },
            {
            listLocation: 'ingredients',
            header: "<strong>Ingredients</strong>"
            },
            {
            listLocation: 'recipes',
            header: "<strong>Recipes</strong>"
            }
            ],
            list:{maxNumberOfElements: 20,onChooseEvent: function(){let url = input.getSelectedItemData().url;console.log(url);window.location.href = url;},showAnimation: {type: "fade", time: 400,callback: function() {}},}}
            input.easyAutocomplete(options);
          ////////////////////////////////////////////////////////////////////////////////////////////////////
          <!-- USER-NAV -->
          %nav.user-nav
            .user-nav__icon-box
              %svg.user-nav__icon
                %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-bookmark"}
              %span.user-nav__notification 10
            .user-nav__icon-box
              %a(href="http:/conversations") 
                %svg.user-nav__icon
                  %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-chat"}
                %span.user-nav__notification= current_user.unread_messages.size
            .user-nav__user
              - if log_in?
                = gravatar_for_login(get_login_user)
                /= image_pack_tag "images/Maciej.jpg", class: "user-nav__user-photo", alt: "Maciej"
                %span.user-nav__user-name
                  = get_login_user_name
                  %svg.user-nav__icon.color-primary
                    %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-caret-down"}
                %nav.sidebar.user-nav__user-sidebar
                  %ul.user-nav__user-menu
                    %li.user-nav__user-item
                      %a.user-nav__user__link{href: "/#{get_type_of_login}/edit"}
                        %svg.side-nav__icon
                          %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-pencil1"}
                        %span Edit your data
                    %li.user-nav__user-item.user-nav__user-theme-chooser
                      %a.user-nav__user__link{href: '#'}
                        %svg.side-nav__icon
                          %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-paint-brush"}
                        %span Choose theme
                        %ul.user-nav__user-theme__choose#theme-chooser

                    %li.user-nav__user-item
                      %a.user-nav__user__link{href: "/#{get_type_of_login}/sign_out", "data-method" => 'delete'}
                        %svg.side-nav__icon
                          %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-power-off"}
                        %span Logout

              - else
                = link_to 'Zaloguj sie',  new_customer_session_path
                -# = image_tag "Maciej.jpg", class: "user-nav__user-photo", alt: "Maciej"
                -# %span.user-nav__user-name Maciej

        .content
          %nav.sidebar
            - if get_type_of_login == 'users'
              %ul.side-nav
                %li{class: "#{(action_name == 'dashboard' && controller_name == 'main')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/main/dashboard"}
                    %svg.side-nav__icon
                      %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-home"}
                    %span Dashboard
                %li{class: "#{(controller_name == 'conversations' || controller_name == 'messages')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/conversations"}
                    %svg.side-nav__icon
                      %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-envelope-o"}
                    %span Messages
                %li{class: "#{(controller_name == 'appointments')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/appointments"}
                    %svg.side-nav__icon
                      %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-calendar"}
                    %span Timetable
                %li{class: "#{(controller_name == 'customers')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/customers"}
                    %svg.side-nav__icon
                      %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-location-restroom"}
                    %span Customers
                %li{class: "#{(controller_name == 'workload_parts' || controller_name == 'workload_weeks' || controller_name == 'workload_temps')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/"}
                    %i.fas.fa-running.side-nav__icon{style:"font-size:2rem;"}
                    %span Workloads
                %li{class: "#{(controller_name == 'exercises')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/exercises"}
                    %svg.side-nav__icon
                      %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-accessibility"}
                    %span Exercises
                %li{class: "#{(controller_name == 'diet_set_categories')||(controller_name == 'diet_set_templates'||(controller_name == 'diet_sets'))?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/"}
                    %i.fas.fa-concierge-bell.side-nav__icon{style:"font-size:2rem;"}
                    %span Diets
                %li{class: "#{(controller_name == 'recipes')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/recipes"}
                    %svg.side-nav__icon
                      %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-forkandspoon"}
                    %span Recipes
                %li{class: "#{(controller_name == 'ingredients')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/ingredients"}
                    %svg.side-nav__icon
                      %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-bowl"}
                    %span Ingredients
                %li{class: "#{(action_name == 'settings' && controller_name == 'main')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/main/settings"}
                    %svg.side-nav__icon
                      %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-cog"}
                    %span Settings
            - else
              %ul.side-nav
                %li{class: "#{(action_name == 'customer' && controller_name == 'main')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/"}
                    %svg.side-nav__icon
                      %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-home"}
                    %span Dashboard
                %li{class: "#{(action_name == 'index' && controller_name == 'trenings')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "#"}
                    %svg.side-nav__icon
                      %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-accessibility"}
                    %span Treningi
                %li{class: "#{(controller_name == 'recipes')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/recipes"}
                    %svg.side-nav__icon
                      %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-forkandspoon"}
                    %span Recipes
                %li{class: "#{(controller_name == 'ingredients')?'side-nav__item side-nav__item--active':'side-nav__item'}"}
                  %a.side-nav__link{href: "/ingredients"}
                    %svg.side-nav__icon
                      %use{"xlink:href" => "#{asset_path('sprite.svg')}#icon-bowl"}
                    %span Ingredients
            %span.legal &copy; 2023 Dhruvi Infinity Inspiration.
          %main.main-view
            %svg{style: "display: none;", xmlns: "http://www.w3.org/2000/svg"}
              %symbol#check-circle-fill{fill: "currentColor", viewbox: "0 0 16 16"}
                %path{d: "M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"}
              %symbol#info-fill{fill: "currentColor", viewbox: "0 0 16 16"}
                %path{d: "M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"}
              %symbol#exclamation-triangle-fill{fill: "currentColor", viewbox: "0 0 16 16"}
                %path{d: "M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"}
            = flash_messages
            = yield
